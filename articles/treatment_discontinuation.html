<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Summarising treatment adherence • DrugUtilisation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarising treatment adherence">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DrugUtilisation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package functionalities</h6></li>
    <li><a class="dropdown-item" href="../articles/mock_data.html">Create mock data to test DrugUtilisation package</a></li>
    <li><a class="dropdown-item" href="../articles/create_cohorts.html">Creating drug cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/indication.html">Identify and summarise indications among a drug cohort</a></li>
    <li><a class="dropdown-item" href="../articles/daily_dose_calculation.html">Daily dose calculation</a></li>
    <li><a class="dropdown-item" href="../articles/drug_utilisation.html">Getting drug utilisation related information of subjects in a cohort</a></li>
    <li><a class="dropdown-item" href="../articles/summarise_treatments.html">Summarise treatments</a></li>
    <li><a class="dropdown-item" href="../articles/treatment_discontinuation.html">Summarising treatment adherence</a></li>
    <li><a class="dropdown-item" href="../articles/drug_restart.html">Assessing drug restart and switching after treatment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/darwin-eu/DrugUtilisation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Summarising treatment adherence</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/darwin-eu/DrugUtilisation/blob/main/vignettes/treatment_discontinuation.Rmd" class="external-link"><code>vignettes/treatment_discontinuation.Rmd</code></a></small>
      <div class="d-none name"><code>treatment_discontinuation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we will go through two common approaches for
assessing treatment adherence that can be performed after creating drug
cohorts. The first approach is to assess time-to-discontinuation using
survival methods, while the second is to estimate the proportion of
patients covered.</p>
</div>
<div class="section level2">
<h2 id="adherence-to-amoxicillin">Adherence to amoxicillin<a class="anchor" aria-label="anchor" href="#adherence-to-amoxicillin"></a>
</h2>
<p>For example, let’s say we would like to study adherence among new
users of amoxicillin over the first 90-days of use. For this we can
first create our amoxicillin study cohort. Here we’ll use the synthetic
Eunomia dataset to show how this could be done.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/DrugUtilisation/">DrugUtilisation</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, dbdir <span class="op">=</span> <span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomiaDir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdmFromCon.html" class="external-link">cdmFromCon</a></span><span class="op">(</span></span>
<span>  con <span class="op">=</span> <span class="va">db</span>,</span>
<span>  cdmSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  writeSchema <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  cdmName <span class="op">=</span> <span class="st">"Eunomia"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generateIngredientCohortSet.html">generateIngredientCohortSet</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  ingredient <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  gapEra <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="time-to-discontinuation">Time-to-discontinuation<a class="anchor" aria-label="anchor" href="#time-to-discontinuation"></a>
</h3>
<p>We can estimate Kaplan-Meier survival curves we can use
estimateSingleEventSurvival from the CohortSurvival package, with the
follow-up beginning from an individual’s cohort start date and
discontinuation occurring at their cohort end date. As the outcome
washout is set to Inf we’ll only be considering the first cohort entry
for an individual. It is important to note that because the survival
analysis is focused on a single cohort entry, with the cohort end date
taken to indicate treatment discontinuation, the gap era used above when
creating the drug cohort can often have an important impact on the
results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">discontinuationSummary</span> <span class="op">&lt;-</span> <span class="fu">CohortSurvival</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CohortSurvival/reference/estimateSingleEventSurvival.html" class="external-link">estimateSingleEventSurvival</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  targetCohortTable <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  outcomeCohortTable <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  outcomeDateVariable <span class="op">=</span> <span class="st">"cohort_end_date"</span>,</span>
<span>  outcomeWashout <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  followUpDays <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  eventGap <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can plot our study result like so:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CohortSurvival::plotSurvival(discontinuationSummary)</span></span></code></pre></div>
<p>Or we can similarly create a table summarising the result</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CohortSurvival::tableSurvival(discontinuationSummary)</span></span></code></pre></div>
<p>We can also easily stratify our results. Here we add patient
demographics to our cohort table using the PatientProfiles packages and
then stratify results by age group and sex.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdm</span><span class="op">$</span><span class="va">amoxicillin</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">amoxicillin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">PatientProfiles</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/PatientProfiles/reference/addDemographics.html" class="external-link">addDemographics</a></span><span class="op">(</span></span>
<span>    ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">41</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"amoxicillin"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">discontinuationSummary</span> <span class="op">&lt;-</span> <span class="fu">CohortSurvival</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CohortSurvival/reference/estimateSingleEventSurvival.html" class="external-link">estimateSingleEventSurvival</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_group"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  targetCohortTable <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  outcomeCohortTable <span class="op">=</span> <span class="st">"amoxicillin"</span>,</span>
<span>  outcomeDateVariable <span class="op">=</span> <span class="st">"cohort_end_date"</span>,</span>
<span>  followUpDays <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  eventGap <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Again we could present our results in a plot or a table.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CohortSurvival::plotSurvival(discontinuationSummary, facet = "strata_level")</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CohortSurvival::tableSurvival(discontinuationSummary)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="proportion-of-patients-covered">Proportion of patients covered<a class="anchor" aria-label="anchor" href="#proportion-of-patients-covered"></a>
</h3>
<p>Estimating the proportion of amoxicillin patients covered offers an
alternative approach for describing treatment adherence. Here for each
day following initiation (taken as the first cohort entry for an
individual) we estimate the proportion of patients that have an ongoing
cohort entry among those who are still in observation at that time.
Unlike with the time-to-discontinuation approach shown above, estimating
proportion of patients covered allows for individuals to have
re-initiate the drug after some break. Consequently this method is
typically far less sensitive to the choice of gap era used when creating
the drug cohort.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppcSummary</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">amoxicillin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summariseProportionOfPatientsCovered.html">summariseProportionOfPatientsCovered</a></span><span class="op">(</span>followUpDays <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p>Like with our survival estimates, we can quickly create a plot of our
results</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotProportionOfPatientsCovered.html">plotProportionOfPatientsCovered</a></span><span class="op">(</span><span class="va">ppcSummary</span><span class="op">)</span></span></code></pre></div>
<p><img src="treatment_discontinuation_files/figure-html/unnamed-chunk-10-1.png" width="75%"></p>
<p>Similarly, we can also stratify our results in a similar way.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ppcSummary</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">amoxicillin</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summariseProportionOfPatientsCovered.html">summariseProportionOfPatientsCovered</a></span><span class="op">(</span></span>
<span>    strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age_group"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    followUpDays <span class="op">=</span> <span class="fl">90</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotProportionOfPatientsCovered.html">plotProportionOfPatientsCovered</a></span><span class="op">(</span><span class="va">ppcSummary</span>, facet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"age_group"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="treatment_discontinuation_files/figure-html/unnamed-chunk-12-1.png" width="75%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martí Català, Yuchen Guo, Kim Lopez-Guell, Edward Burn, Nuria Mercade-Besora, Xihang Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
